{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = getTypeInfo;\n\nvar _graphql = require(\"graphql\");\n\nvar _introspection = require(\"graphql/type/introspection\");\n\nvar _forEachState = _interopRequireDefault(require(\"./forEachState\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n/**\n *  Copyright (c) 2019 GraphQL Contributors\n *  All rights reserved.\n *\n *  This source code is licensed under the BSD-style license found in the\n *  LICENSE file in the root directory of this source tree. An additional grant\n *  of patent rights can be found in the PATENTS file in the same directory.\n */\n\n/**\n * Utility for collecting rich type information given any token's state\n * from the graphql-mode parser.\n */\n\n\nfunction getTypeInfo(schema, tokenState) {\n  var info = {\n    schema: schema,\n    type: null,\n    parentType: null,\n    inputType: null,\n    directiveDef: null,\n    fieldDef: null,\n    argDef: null,\n    argDefs: null,\n    objectFieldDefs: null\n  };\n  (0, _forEachState[\"default\"])(tokenState, function (state) {\n    switch (state.kind) {\n      case 'Query':\n      case 'ShortQuery':\n        info.type = schema.getQueryType();\n        break;\n\n      case 'Mutation':\n        info.type = schema.getMutationType();\n        break;\n\n      case 'Subscription':\n        info.type = schema.getSubscriptionType();\n        break;\n\n      case 'InlineFragment':\n      case 'FragmentDefinition':\n        if (state.type) {\n          info.type = schema.getType(state.type);\n        }\n\n        break;\n\n      case 'Field':\n      case 'AliasedField':\n        info.fieldDef = info.type && state.name ? getFieldDef(schema, info.parentType, state.name) : null;\n        info.type = info.fieldDef && info.fieldDef.type;\n        break;\n\n      case 'SelectionSet':\n        info.parentType = (0, _graphql.getNamedType)(info.type);\n        break;\n\n      case 'Directive':\n        info.directiveDef = state.name && schema.getDirective(state.name);\n        break;\n\n      case 'Arguments':\n        var parentDef = state.prevState.kind === 'Field' ? info.fieldDef : state.prevState.kind === 'Directive' ? info.directiveDef : state.prevState.kind === 'AliasedField' ? state.prevState.name && getFieldDef(schema, info.parentType, state.prevState.name) : null;\n        info.argDefs = parentDef && parentDef.args;\n        break;\n\n      case 'Argument':\n        info.argDef = null;\n\n        if (info.argDefs) {\n          for (var i = 0; i < info.argDefs.length; i++) {\n            if (info.argDefs[i].name === state.name) {\n              info.argDef = info.argDefs[i];\n              break;\n            }\n          }\n        }\n\n        info.inputType = info.argDef && info.argDef.type;\n        break;\n\n      case 'EnumValue':\n        var enumType = (0, _graphql.getNamedType)(info.inputType);\n        info.enumValue = enumType instanceof _graphql.GraphQLEnumType ? find(enumType.getValues(), function (val) {\n          return val.value === state.name;\n        }) : null;\n        break;\n\n      case 'ListValue':\n        var nullableType = (0, _graphql.getNullableType)(info.inputType);\n        info.inputType = nullableType instanceof _graphql.GraphQLList ? nullableType.ofType : null;\n        break;\n\n      case 'ObjectValue':\n        var objectType = (0, _graphql.getNamedType)(info.inputType);\n        info.objectFieldDefs = objectType instanceof _graphql.GraphQLInputObjectType ? objectType.getFields() : null;\n        break;\n\n      case 'ObjectField':\n        var objectField = state.name && info.objectFieldDefs ? info.objectFieldDefs[state.name] : null;\n        info.inputType = objectField && objectField.type;\n        break;\n\n      case 'NamedType':\n        info.type = schema.getType(state.name);\n        break;\n    }\n  });\n  return info;\n} // Gets the field definition given a type and field name\n\n\nfunction getFieldDef(schema, type, fieldName) {\n  if (fieldName === _introspection.SchemaMetaFieldDef.name && schema.getQueryType() === type) {\n    return _introspection.SchemaMetaFieldDef;\n  }\n\n  if (fieldName === _introspection.TypeMetaFieldDef.name && schema.getQueryType() === type) {\n    return _introspection.TypeMetaFieldDef;\n  }\n\n  if (fieldName === _introspection.TypeNameMetaFieldDef.name && (0, _graphql.isCompositeType)(type)) {\n    return _introspection.TypeNameMetaFieldDef;\n  }\n\n  if (type.getFields) {\n    return type.getFields()[fieldName];\n  }\n} // Returns the first item in the array which causes predicate to return truthy.\n\n\nfunction find(array, predicate) {\n  for (var i = 0; i < array.length; i++) {\n    if (predicate(array[i])) {\n      return array[i];\n    }\n  }\n}","map":null,"metadata":{},"sourceType":"script"}